<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>arbor - Trees and machine learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Trees and machine learning</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">arbor</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anatomy.html" class="sidebar-item-text sidebar-link">Anatomy of a tree</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./begin.html" class="sidebar-item-text sidebar-link">First driving lesson</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./with-graphs.html" class="sidebar-item-text sidebar-link">Trees and graphs</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fbola.html" class="sidebar-item-text sidebar-link">Fbola example</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./measures.html" class="sidebar-item-text sidebar-link">Tree quality</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./breast-cancer.html" class="sidebar-item-text sidebar-link">Breast cancer example</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml-connection.html" class="sidebar-item-text sidebar-link active">Trees and machine learning</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./configuration.html" class="sidebar-item-text sidebar-link">The configuration box</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#imagining-automating-tree-building" id="toc-imagining-automating-tree-building" class="nav-link active" data-scroll-target="#imagining-automating-tree-building">Imagining automating tree-building</a></li>
  <li><a href="#linear-regression-metaphor" id="toc-linear-regression-metaphor" class="nav-link" data-scroll-target="#linear-regression-metaphor">Linear regression metaphor</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Trees and machine learning</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

    <script src="src/awash-functions.js"></script>
<p>One reason to learn about trees is that they are a topic in Machine Learning (ML), and that topic is a hot one right now. So thinking deeply about trees helps you understand what ML is all about.</p>
<p>This is not the place for a treatise on machine learning. But I will natter on for a bit describing some of the connections I see. If ML is new to you, it should give you an idea of at least one part of ML and where this fits.</p>
<p>So: what’s the connection between classification trees and machine learning?</p>
<p>If you have worked through all of the pages before this one, you’ve seen that, although you can make pretty good trees just using your intuition, there are ways to assign numbers to the quality of the trees you make, and informally optimize a tree. That is, you can make a plausible tree, and then alter it—add another branch, change a break point—and gradually find the best one.</p>
<p>If you do that enough, it probably will occur to you that this is tedious, and wonder if we could have a computer do it.</p>
<p>This business of looking at a set of trees, then finding the best one, and maybe then using that to make another, generally better set of trees, and repeating that process, well, that’s an example of machine learning. It’s creating an <em>algorithm</em> to find the best—or at least a pretty good—version of something.</p>
<section id="imagining-automating-tree-building" class="level3">
<h3 class="anchored" data-anchor-id="imagining-automating-tree-building">Imagining automating tree-building</h3>
<p>It’s one thing to say, we’ll have the computer do the boring part. It’s another to specify exactly what to have the computer do. We will not do that here completely, but we will talk about what’s required for that task.</p>
<section id="the-branch-everything-strategy" class="level4">
<h4 class="anchored" data-anchor-id="the-branch-everything-strategy">The branch-<em>everything</em> strategy</h4>
<p>First, let’s imagine a brute-force procedure: make the biggest tree possible. To do that, take the first “predictor” attribute that you see, and branch the tree using that attribute. Now you have two terminal nodes. Then take the next attribute, and branch both terminal nodes; now you have four. Continue until you’re out of attributes. (If you start with <span class="math inline">\(n\)</span> attributes, you will wind up with <span class="math inline">\(2^n\)</span> terminal nodes…which can be a lot!)</p>
<p>To do that, you still need three things:</p>
<ul>
<li><p>At the beginning, you need a target attribute and you need to know what value(s) of that attribute are “positive.”</p></li>
<li><p>You need to know, for each attribute, if it has more than two values, how to split it: You need a splitting rule—perhaps a cut point.</p></li>
<li><p>At the end, you need to know, for each terminal node, what diagnosis you will assign.</p></li>
</ul>
<p>Your algorithm will have to address those issues. Then, if you’re about to make the <em>last</em> branch, you will notice situations where it makes no sense to branch the tree, for example:</p>
<ul>
<li><p>when the split makes almost no difference in the percentage of cases that are positive.</p></li>
<li><p>when the number of cases in a branch is small</p></li>
</ul>
<p>So to make a “trimmer” tree, your algorithm will need to specify what “almost no difference” or “small” mean.</p>
<p>You might also look at your completed tree and decide to “prune” it—to eliminate additional branches that yield little difference or have too few cases.</p>
</section>
<section id="a-more-prudent-and-frugal-strategy" class="level4">
<h4 class="anchored" data-anchor-id="a-more-prudent-and-frugal-strategy">A more prudent and frugal strategy</h4>
<p>An alternative to branching everything is to be more careful about what branches you make. Imagine these steps:</p>
<ol type="1">
<li><p>Take all the attributes and make a tree for each one, with just that first split.</p></li>
<li><p>For each tree, calculate how good the tree is using some measure such as the MCR (misclassification rate).</p></li>
<li><p>Take the best tree as measured by that MCR, returning to step 1 using only the remaining attributes.</p></li>
<li><p>If you ever get a split that’s too little difference or too small, stop branching that part of the tree.</p></li>
</ol>
<p>You still need to define many things, but this will generally yield smaller, more wieldy trees.</p>
</section>
</section>
<section id="linear-regression-metaphor" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="linear-regression-metaphor">Linear regression metaphor</h3>
<div class="page-columns page-full"><p>Let’s assume we all understand about least-squares linear regression, a process by which, given a set of data points, we find a line that minimizes the sum of the squares of the residuals. We compute the parameters of that line—the slope and intercept, <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span>—using some formulas. And those formulas get derived using calculus.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;This is not surprising, because this is an optimization problem with quadratic functions (sum of <em>squares</em>) so it involves setting a derivative equal to zero…and so forth.</p></li></div></div>
<p>Now let’s imagine that we don’t have calculus.</p>
<p>We can still solve the problem using an iterative process. Maybe we begin using the function <span class="math inline">\(m=0\)</span> and <span class="math inline">\(b=0\)</span>, that is, <span class="math inline">\(y=0x+0\)</span>. We can compute the sum of squares of the residuals. Then, at every step, we look at new values of <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span>, offset a little from their current values, and calculate the sum of squares from new lines defined by the new values. We pick the line with the lowest sum of squares and then do it all over again. Gradually, when we get close, we can reduce the offsets, and thereby find an optimum line to as great a precision as you like.</p>
<p>You can even imagine this as walking on a <em>surface</em>. The <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> axes define a horizontal plane, and the height (<span class="math inline">\(z\)</span>) of the surface is the sum of squares for each location <span class="math inline">\((m, b)\)</span>. Our task is to find the lowest point on the surface.</p>
<p>Calculus does it immediately, but we have the computing power to do the “walk” very efficiently and quickly. And of course, this procedure—which is called <em>gradient descent</em> in ML-speak—works even when calculus does not.</p>
<p>cost: entropy, gini instead of SSR</p>
<p>training and test sets</p>
<p>overfitting</p>


</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>